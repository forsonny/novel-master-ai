{
	"id": "analyze-complexity",
	"version": "1.0.0",
	"description": "Analyze narrative complexity (pacing, POV load, stakes) and recommend expansion guidance",
	"metadata": {
		"author": "system",
		"created": "2024-01-01T00:00:00Z",
		"updated": "2025-01-15T00:00:00Z",
		"tags": ["analysis", "pacing", "narrative", "recommendations"]
	},
	"parameters": {
		"tasks": {
			"type": "array",
			"required": true,
			"description": "Array of narrative tasks (acts/chapters/arcs) to analyze"
		},
		"gatheredContext": {
			"type": "string",
			"default": "",
			"description": "Additional project context (outline, lore, prior drafts)"
		},
		"threshold": {
			"type": "number",
			"default": 5,
			"min": 1,
			"max": 10,
			"description": "Complexity threshold for recommending expansion"
		},
		"useResearch": {
			"type": "boolean",
			"default": false,
			"description": "Use genre/world research while analyzing"
		},
		"hasManuscriptContext": {
			"type": "boolean",
			"default": false,
			"description": "Whether manuscript files are accessible"
		},
		"hasCodebaseAnalysis": {
			"type": "boolean",
			"default": false,
			"description": "Deprecated: Use hasManuscriptContext instead. Whether manuscript files are accessible"
		},
		"projectRoot": {
			"type": "string",
			"default": "",
			"description": "Project root path for context"
		}
	},
	"prompts": {
		"default": {
			"system": "You are an expert narrative editor analyzing pacing, POV balance, and emotional stakes. Score each task from 1-10 based on the effort/risk required to fulfill it (plot density, character count, research burden, continuity risk). Recommend how many subtasks (scenes/revision passes) should be generated and provide an expansion prompt tailored to that task.\n\nReturn a JSON object with a single \"complexityAnalysis\" property containing an array of entries. Each entry must include: taskId, taskTitle, complexityScore (1-10), recommendedSubtasks (integer), expansionPrompt (string), and reasoning (string). You may optionally include \"metadata\" at the top level but no other properties.",
			"user": "{{#if (or hasManuscriptContext hasCodebaseAnalysis)}}## OPTIONAL: Manuscript Context Available\nReview `.novelmaster/manuscript` and existing task files to gauge drafted material, POV distribution, and unresolved threads. Use that insight to calibrate complexity scores.\n\nProject Root: {{projectRoot}}\n\n{{/if}}Analyze the following narrative tasks to determine their complexity and whether expansion is needed.{{#if useResearch}} Fold in genre research, reader expectations, and current publishing trends while reasoning.{{/if}}\n\nTasks:\n{{{json tasks}}}{{#if gatheredContext}}\n\n# Project Context\n{{gatheredContext}}{{/if}}"
		}
	}
}
